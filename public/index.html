<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MP3/MP4 Transcriber</title>
  <!-- Include Socket.IO client library -->
  <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
</head>
<body>
  <h1>Upload je MP3/MP4-bestand</h1>
  <form id="uploadForm" enctype="multipart/form-data">
    <Label>Video naam:</Label>

    <!-- required voor nu uit -->
    <input type="text" name="naam" id="video_naam" > 
    <input type="file" name="audio" id="audio" accept=".mp3, .mp4, .wav" >

    <button type="submit">Transcribe</button>
    <button id="videoUpload">Upload video informatie</button>
    <button id="triggerEventButton" style="display: none;">Trigger Transcription</button>
  </form>  

  <hr>

  <div id="loadingBar" style="width: 100%; background-color: #ddd;">
    <div id="progressBar" style="width: 0%; height: 20px; background-color: #4c6faf;"></div>
  </div>
  <video id="1" width="300" height="auto" controls>
    <source src="./ghost.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <script>
    const videoElement = document.getElementById('1');
    const video_id = 1;
    
    fetch(`/subtitle/${video_id}`)
        .then(response => {
            const track = document.createElement('track');
            track.kind = 'subtitles';
            track.label = 'Nederlands';
            track.src = `temp/${video_id}.vtt`;
            track.srclang = 'nl';
            track.default = true;
            videoElement.appendChild(track);
        })
        .catch(error => console.error('Fout bij het laden van ondertitels:', error));
  </script>

  <hr>

  <select id="videoSelect" style="display: none;"></select>
  <button id="scriptOphalen" style="display: none;">Transcripts ophalen</button>
  <select id="languageSelect" style="display: none;"></select>

  <button id="uploadButton" style="display: none;">Upload Transcriptie</button>
  <button id="translateButton" style="display: none;">Vertaal Transcriptie</button>
  <button id="downloadButton" style="display: none;">Download Transcriptie</button>

  <hr>

  <button id="editOphalen">Transcript ophalen</button>
  <select id="languageSelectChange"></select>
  <select id="videoSelectChange"></select>
  <script>
      fetch('http://localhost:3000/talen')
      .then(response => response.json())
      .then(data => {
          const select = document.getElementById('languageSelectChange');
          data.forEach(lang => {
          const option = document.createElement('option');
          option.value = lang.afkorting;
          option.textContent = lang.naam;
          option.title = lang.afkorting;

          if (lang.naam === "DUTCH") {
              option.selected = true;
          }

          select.appendChild(option);
          });
      })
      .catch(error => console.error('Fout bij ophalen talen:', error));

    fetch('http://localhost:3000/videos')
      .then(response => response.json())
      .then(data => {
      const select = document.getElementById('videoSelectChange');
      data.forEach(lang => {
          const option = document.createElement('option');
          option.value = lang.id;
          option.textContent = lang.naam;
          option.title = lang.file_name;
          select.appendChild(option);
      });
      })
      .catch(error => console.error('Fout bij ophalen talen:', error));
  </script>
<form id="change" name="transcriptChange" method="POST" action="/subtitle/{video_id}/{taal}/update">

  <script>
    const form = document.getElementById('change');
    form.action = `/subtitle/${video_id}/${taal}/update`;
  </script>

  <button type="submit" id="submitButton2" style="display: none;">Submit Change</button>
</form>

<form id="link" name="linkSubmit" method="post" action="/transcribe/link">
  <script>
    const forms = document.getElementById('link');
    forms.action = `/transcribe/link`
  </script>
  <input type="url" name="videoUrl" id="link" placeholder="Voer de video-URL in" required>
  <button type="submit" id="linkSubmit">Submit Link</button>
</form>


  <pre id="transcriptionMSG"></pre>
  <pre id="transcription"></pre>


<script methode="module" src="script.js"></script>
</body>
</html>